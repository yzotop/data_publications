---
link: https://t.me/suranalytics/86
tags:
  - data
data_type:
  - AB tests
author: Balandin
source: telegram
company: Aviasales
---
Неочевидная причина, почему ваши А/Б-тесты могут быть некорректными. 

Sample Ratio Mismatch (SRM) - когда отношение вариантов не равняется тому, которое вы задавали. Например, вы планировали распределение в тесте - 50/50, а в итоговых данных - 45/55. Это достаточно частая проблема, от которой страдают даже топовые компании, например, в LinkedIn порядка 10% тестов имели SRM, в Microsoft - 6%. 

Почему это плохо? Некорректное распределение - это симптом того, что в вашем тесте что-то не так. Одно из основных предположений для корректного эксперимента - пользователи должны распределяться по вариантам независимо и случайно. Если нарушается распределение, то вероятно на ваш тест влияют какие-то переменные, вызывая разницу в том, какие и как пользователи попадают в группы. Это в свою очередь будет влиять на итоговую метрику. Тем самым, эксперимент становится недостоверным. 

Перед тем как искать причины необходимо понять, что проблема вообще есть. Для обнаружения считают p-value с использованием chi-square тест. Вот калькулятор, (https://www.gigacalculator.com/calculators/sample-ratio-mismatch-calculator.php) который в этом поможет. 

Ряд проблем, которые могут вызывать SRM:
- Некорректность сплитования 
- Ломается код в одном из вариантов, из-за чего пользователи не попадают в тест
- Проблемы с логами и данными в целом 
- Некорректный анализ данных при подсчете результатов

На картинке причины, которые могут появляться на каждом из этапов эксперимента, взято из стати ExP. 

Как же найти причину?
- Посмотреть на сегменты. Возможно проблема есть для одного браузера или только для новых пользователей. 
- Посмотреть на SRM в динамике. Сразу ли начались проблемы в тесте или появились начиная с какого-то момента?
- Попросить разработчиков проверить код распределения вариантов и реализацию новой фичи.

Более подробно про SRM можно почитать в блоге Microsoft (https://www.microsoft.com/en-us/research/group/experimentation-platform-exp/articles/diagnosing-sample-ratio-mismatch-in-a-b-testing/) и в статье от ExP. (https://exp-platform.com/Documents/2019_KDDFabijanGupchupFuptaOmhoverVermeerDmitriev.pdf)

